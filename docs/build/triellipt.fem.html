<!DOCTYPE html>
<html lang="en">

<head>
    <title>Modules — triellipt documentation</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" charset="utf-8">
    <link rel="stylesheet" href="docpage.css">
    <script src="docpage.js"></script>
</head>

<body>

    <div id="top-panel">
        <div id="page-logo"></div>
        <div id="top-panel-tool-bar">
            <div id="global-toc-btn" class="top-panel-btn" onclick="switchTOC(this)"></div>
            <div id="local-toc-btn" class="top-panel-btn" onclick="switchTOC(this)"></div>
            <div id="home-page-btn" class="top-panel-btn" onclick="gotoHomePage()"></div>
        </div>
    </div>

    <div id="global-toc-box" class="toc-box">
        <div class="toc-box__header">
            <p>Contents</p><button onclick="closeTOC(this)">&#x2715;</button>
        </div>
        <div id="global-toc-box__text" class="toc-box__textbox"></div>
    </div>
    <div id="local-toc-box" class="toc-box">
        <div class="toc-box__header">
            <p>On this page</p><button onclick="closeTOC(this)">&#x2715;</button>
        </div>
        <div id="local-toc-box__text" class="toc-box__textbox">
            <p>
            <ul>
                <li><a href="#triellipt.fem">triellipt.fem</a>
                    <ul>
                        <li><a href="#getunit">getunit()</a></li>
                        <li><a href="#getdtn">getdtn()</a></li>
                        <li><a href="#femunit">FEMUnit</a>
                            <ul>
                                <li><a href="#add_partition">add_partition()</a></li>
                                <li><a href="#get_partition">get_partition()</a></li>
                                <li><a href="#del_partition">del_partition()</a></li>
                                <li><a href="#getinterp">getinterp()</a></li>
                                <li><a href="#massopr">massopr()</a></li>
                                <li><a href="#average">average()</a></li>
                            </ul>
                        </li>
                        <li><a href="#femdtn">FEMDtN</a>
                            <ul>
                                <li><a href="#dirich_sides">dirich_sides()</a></li>
                                <li><a href="#switch_side">switch_side()</a></li>
                            </ul>
                        </li>
                        <li><a href="#fempartt">FEMPartt</a>
                            <ul>
                                <li><a href="#new_vector">new_vector()</a></li>
                                <li><a href="#new_matrix">new_matrix()</a></li>
                                <li><a href="#get_nodes">get_nodes()</a></li>
                            </ul>
                        </li>
                        <li><a href="#matrixfem">MatrixFEM</a>
                            <ul>
                                <li><a href="#getblock">getblock()</a></li>
                            </ul>
                        </li>
                        <li><a href="#vectorfem">VectorFEM</a>
                            <ul>
                                <li><a href="#with_body">with_body()</a></li>
                                <li><a href="#from_func">from_func()</a></li>
                                <li><a href="#constrained">constrained()</a></li>
                                <li><a href="#getsection">getsection()</a></li>
                                <li><a href="#setsection">setsection()</a></li>
                            </ul>
                        </li>
                        <li><a href="#mesh_grad">mesh_grad()</a></li>
                        <li><a href="#mesh_geom">mesh_geom()</a></li>
                        <li><a href="#mesh_metric">mesh_metric()</a></li>
                    </ul>
                </li>
            </ul>
            </p>
        </div>
    </div>

    <div id="content-box">
        <div id="title-box">
            <h1 id="title-box__title"></h1>
            <h2 id="title-box__annotation"></h2>
            <hr>
        </div>
        <div id="doc-box">
<div class="toc-anchor"></div><h1>triellipt.fem</h1>

<p>FEM (P1) solver.</p>

<div class="toc-anchor"></div><h2>getunit()</h2>

<pre class="py-sign">triellipt.fem.<b>getunit</b>(mesh, anchors=<span>None</span>, mode=<span>None</span>)</pre>

<p>Creates a FEM computing unit.</p>

<p><b>Parameters</b></p>

<p><span class="vardef"><code>mesh</code> : <em>TriMesh</em></span></p>

<dl><dd>
  Input triangle mesh.
</dd></dl>

<p><span class="vardef"><code>anchors</code> : <em>Iterable = None</em></span></p>

<dl><dd>
  Provides <code>(float, float)</code> points to synchronize the mesh boundary.
</dd></dl>

<p><span class="vardef"><code>mode</code> : <em>str = None</em></span></p>

<dl><dd>
  Solver mode — <i>&quot;fvm&quot;</i> or <i>&quot;fem&quot;</i> (default).
</dd></dl>

<p><b>Returns</b></p>

<p><span class="vardef"><em>FEMUnit</em></span></p>

<dl><dd>
  FEM computing unit.
</dd></dl>

<div class="toc-anchor"></div><h2>getdtn()</h2>

<pre class="py-sign">triellipt.fem.<b>getdtn</b>(mesh, anchors, mode=<span>None</span>)</pre>

<p>Creates a FEM-DtN unit.</p>

<p><b>Parameters</b></p>

<p><span class="vardef"><code>mesh</code> : <em>TriMesh</em></span></p>

<dl><dd>
  Input triangle mesh.
</dd></dl>

<p><span class="vardef"><code>anchors</code> : <em>Iterable</em></span></p>

<dl><dd>
  Provides <code>(float, float)</code> points to partition the mesh boundary.
</dd></dl>

<p><span class="vardef"><code>mode</code> : <em>str = None</em></span></p>

<dl><dd>
  Solver mode — <i>&quot;fvm&quot;</i> or <i>&quot;fem&quot;</i> (default).
</dd></dl>

<p><b>Returns</b></p>

<p><span class="vardef"><em>FEMDtN</em></span></p>

<dl><dd>
  FEM-DtN computing unit.
</dd></dl>

<p><b>Notes</b></p>

<p>FEM-DtN units are only supported for simply-connected meshes.</p>

<div class="toc-anchor"></div><h2>FEMUnit</h2>

<pre class="py-sign"><b><em>class</em></b> triellipt.fem.<b>FEMUnit</b>(mesh=<span>None</span>, meta=<span>None</span>)</pre>

<p>FEM computing unit.</p>

<p><b>Properties</b></p>

<p>Basic FEM operators as data-streams:</p>

<table>
    <tr>
        <th>Name</th>
        <th>Description</th>
    </tr>
    <tr>
        <td><code>massmat</code></td>
        <td>Mass-matrix</td>
    </tr>
    <tr>
        <td><code>massdig</code></td>
        <td>Mass-matrix lumped</td>
    </tr>
    <tr>
        <td><code>diff_1y</code></td>
        <td>1st y-derivative (weak)</td>
    </tr>
    <tr>
        <td><code>diff_1x</code></td>
        <td>1st x-derivative (weak)</td>
    </tr>
    <tr>
        <td><code>grad_1y</code></td>
        <td>1st y-derivative (strong)</td>
    </tr>
    <tr>
        <td><code>grad_1x</code></td>
        <td>1st x-derivative (strong)</td>
    </tr>
    <tr>
        <td><code>diff_2y</code></td>
        <td>2nd y-derivative (weak)</td>
    </tr>
    <tr>
        <td><code>diff_2x</code></td>
        <td>2nd x-derivative (weak)</td>
    </tr>
    <tr>
        <td><code>diff_yx</code></td>
        <td>2nd yx-derivative (weak)</td>
    </tr>
    <tr>
        <td><code>diff_xy</code></td>
        <td>2nd xy-derivative (weak)</td>
    </tr>
</table>

<p>General properties:</p>

<table>
    <tr>
        <th>Name</th>
        <th>Description</th>
    </tr>
    <tr>
        <td><code>grad</code></td>
        <td>Gradient operator (a).</td>
    </tr>
    <tr>
        <td><code>geom</code></td>
        <td>Geometric properties (b).</td>
    </tr>
    <tr>
        <td><code>perm</code></td>
        <td>Mesh-to-unit permutation (c).</td>
    </tr>
    <tr>
        <td><code>base</code></td>
        <td>Basic edge-core partition.</td>
    </tr>
    <tr>
        <td><code>loops</code></td>
        <td>List of the mesh loops.</td>
    </tr>
    <tr>
        <td><code>partts</code></td>
        <td>Map of the unit partitions.</td>
    </tr>
</table>

<p><b>Notes</b></p>

<p>
<ul class="md-list">
    <li>(a) <code>TriGrad</code> as returned by <code>mesh_grad()</code></li>
    <li>(b) <code>MeshGeom</code> as returned by <code>mesh_geom()</code></li>
    <li>(c) <code>DataPerm</code> object with the attributes:
        <ul>
            <li><code>mesh</code> is the parent mesh</li>
            <li><code>perm</code> is the permutation from the parent mesh</li>
        </ul>
    </li>
</ul>
</p>

<div class="toc-anchor"></div><h3>add_partition()</h3>

<pre class="py-sign">FEMUnit.<b>add_partition</b>(<em>self</em>, partt_spec)</pre>

<p>Adds new partition to the unit.</p>

<p><b>Parameters</b></p>

<p><span class="vardef"><code>partt_spec</code> : <em>dict</em></span></p>

<dl><dd>
  Partition specification.
</dd></dl>

<p><b>Returns</b></p>

<p><span class="vardef"><em>self</em></span></p>

<dl><dd>
  Unit with the partition added.
</dd></dl>

<div class="toc-anchor"></div><h3>get_partition()</h3>

<pre class="py-sign">FEMUnit.<b>get_partition</b>(<em>self</em>, partt_name)</pre>

<p>Fetches the unit partition.</p>

<p><b>Parameters</b></p>

<p><span class="vardef"><code>partt_name</code> : <em>str</em></span></p>

<dl><dd>
  Partition name.
</dd></dl>

<p><b>Returns</b></p>

<p><span class="vardef"><em>FEMPartt</em></span></p>

<dl><dd>
  Desired unit partition.
</dd></dl>

<div class="toc-anchor"></div><h3>del_partition()</h3>

<pre class="py-sign">FEMUnit.<b>del_partition</b>(<em>self</em>, name) → <em>None</em></pre>

<p>Deletes the specified partition from the unit.</p>

<div class="toc-anchor"></div><h3>getinterp()</h3>

<pre class="py-sign">FEMUnit.<b>getinterp</b>(<em>self</em>, xnodes, ynodes)</pre>

<p>Creates an interpolator on a mesh.</p>

<p><b>Parameters</b></p>

<p><span class="vardef"><code>xnodes</code> : <em>flat-float-array</em></span></p>

<dl><dd>
  x-coordinates of the interpolation nodes.
</dd></dl>

<p><span class="vardef"><code>ynodes</code> : <em>flat-float-array</em></span></p>

<dl><dd>
  y-coordinates of the interpolation nodes.
</dd></dl>

<p><b>Returns</b></p>

<p><span class="vardef"><em>TriInterp</em></span></p>

<dl><dd>
  Callable interpolator.
</dd></dl>

<p><b>Notes</b></p>

<p><code>TriInterp</code> object has the following attributes:</p>

<p>
<ul class="md-list">
    <li><code>xnodes</code> contains interpolation x-nodes</li>
    <li><code>xnodes</code> contains interpolation y-nodes</li>
</ul>
</p>

<p><code>TriInterp()</code> takes nodes-data and returns interpolated one.</p>

<div class="toc-anchor"></div><h3>massopr()</h3>

<pre class="py-sign">FEMUnit.<b>massopr</b>(<em>self</em>, is_lumped, add_constr)</pre>

<p>Creates the mass operator from the base partition.</p>

<p><b>Parameters</b></p>

<p><span class="vardef"><code>is_lumped</code> : <em>bool</em></span></p>

<dl><dd>
  Creates a lumped mass operator, if <em>True</em>.
</dd></dl>

<p><span class="vardef"><code>add_constr</code> : <em>bool</em></span></p>

<dl><dd>
  Adds constraints, if <em>True</em>.
</dd></dl>

<p><b>Returns</b></p>

<p><span class="vardef"><em>MatrixFEM</em></span></p>

<dl><dd>
  Mass operator as a matrix.
</dd></dl>

<div class="toc-anchor"></div><h3>average()</h3>

<pre class="py-sign">FEMUnit.<b>average</b>(<em>self</em>, data)</pre>

<p>Converts node-based data to triangle-averaged values.</p>

<p><b>Parameters</b></p>

<p><span class="vardef"><code>data</code> : <em>float-flat-array</em></span></p>

<dl><dd>
  Node-based data.
</dd></dl>

<p><b>Returns</b></p>

<p><span class="vardef"><em>float-flat-array</em></span></p>

<dl><dd>
  Triangle-averaged values.
</dd></dl>

<div class="toc-anchor"></div><h2>FEMDtN</h2>

<pre class="py-sign"><b><em>class</em></b> triellipt.fem.<b>FEMDtN</b>(unit=<span>None</span>)</pre>

<p>FEM-DtN computing unit.</p>

<p><b>Properties</b></p>

<table>
    <tr>
        <th>Name</th>
        <th>Description</th>
    </tr>
    <tr>
        <td><code>fem</code></td>
        <td>Parent FEM unit.</td>
    </tr>
    <tr>
        <td><code>dtn</code></td>
        <td>DtN partition.</td>
    </tr>
</table>

<div class="toc-anchor"></div><h3>dirich_sides()</h3>

<pre class="py-sign">FEMDtN.<b>dirich_sides</b>(<em>self</em>) → <em>list</em></pre>

<p>Returns a list of Dirichlet sides.</p>

<div class="toc-anchor"></div><h3>switch_side()</h3>

<pre class="py-sign">FEMDtN.<b>switch_side</b>(<em>self</em>, key)</pre>

<p>Switches the DtN state of the boundary part.</p>

<p><b>Parameters</b></p>

<p><span class="vardef"><code>key</code> : <em>int</em></span></p>

<dl><dd>
  Index of the boundary part.
</dd></dl>

<p><b>Returns</b></p>

<p><span class="vardef"><em>self</em></span></p>

<dl><dd>
  Unit itself.
</dd></dl>

<div class="toc-anchor"></div><h2>FEMPartt</h2>

<pre class="py-sign"><b><em>class</em></b> triellipt.fem.<b>FEMPartt</b>(unit, meta, edge)</pre>

<p>FEM unit partition.</p>

<p><b>Properties</b></p>

<table>
    <tr>
        <th>Name</th>
        <th>Description</th>
    </tr>
    <tr>
        <td><code>core</code></td>
        <td>Core section.</td>
    </tr>
    <tr>
        <td><code>edge</code></td>
        <td>Map of edge sections.</td>
    </tr>
    <tr>
        <td><code>meta</code></td>
        <td>Partition metadata.</td>
    </tr>
</table>

<div class="toc-anchor"></div><h3>new_vector()</h3>

<pre class="py-sign">FEMPartt.<b>new_vector</b>(<em>self</em>)</pre>

<p>Creates a new FEM vector.</p>

<p><b>Returns</b></p>

<p><span class="vardef"><em>VectorFEM</em></span></p>

<dl><dd>
  New empty FEM vector.
</dd></dl>

<div class="toc-anchor"></div><h3>new_matrix()</h3>

<pre class="py-sign">FEMPartt.<b>new_matrix</b>(<em>self</em>, operator, add_constr=<span>False</span>)</pre>

<p>Creates a new FEM matrix.</p>

<p><b>Parameters</b></p>

<p><span class="vardef"><code>operator</code> : <em>flat-float-array</em></span></p>

<dl><dd>
  Linear combination of the basic FEM operators.
</dd></dl>

<p><span class="vardef"><code>add_constr</code> : <em>bool = False</em></span></p>

<dl><dd>
  Constraints are included in the matrix, if <em>True</em>.
</dd></dl>

<p><b>Returns</b></p>

<p><span class="vardef"><em>MatrixFEM</em></span></p>

<dl><dd>
  Resulting FEM matrix.
</dd></dl>

<div class="toc-anchor"></div><h3>get_nodes()</h3>

<pre class="py-sign">FEMPartt.<b>get_nodes</b>(<em>self</em>, key)</pre>

<p>Retrieves the points of the partition section.</p>

<p><b>Parameters</b></p>

<p><span class="vardef"><code>key</code> : <em>int</em></span></p>

<dl><dd>
  Number of the partition section.
</dd></dl>

<p><b>Returns</b></p>

<p><span class="vardef"><em>two-row-float-array</em></span></p>

<dl><dd>
  Points of the partition section stacked horizontally.
</dd></dl>

<p><b>Notes</b></p>

<p>This method is also available as <code>nodes2d(key)</code>.</p>

<div class="toc-anchor"></div><h2>MatrixFEM</h2>

<pre class="py-sign"><b><em>class</em></b> triellipt.fem.<b>MatrixFEM</b>(partt=<span>None</span>, body=<span>None</span>, meta=<span>None</span>)</pre>

<p>Global FEM matrix.</p>

<div class="toc-anchor"></div><h3>getblock()</h3>

<pre class="py-sign">MatrixFEM.<b>getblock</b>(<em>self</em>, row_id, col_id)</pre>

<p>Extracts a block of a matrix.</p>

<p><b>Parameters</b></p>

<p><span class="vardef"><code>row_id</code> : <em>int</em></span></p>

<dl><dd>
  ID of the vertical section.
</dd></dl>

<p><span class="vardef"><code>col_id</code> : <em>int</em></span></p>

<dl><dd>
  ID of the horizontal section.
</dd></dl>

<p><b>Returns</b></p>

<p><span class="vardef"><em>csc-matrix</em></span></p>

<dl><dd>
  Matrix bock in CSC format.
</dd></dl>

<div class="toc-anchor"></div><h2>VectorFEM</h2>

<pre class="py-sign"><b><em>class</em></b> triellipt.fem.<b>VectorFEM</b>(partt=<span>None</span>, body=<span>None</span>)</pre>

<p>FEM vector.</p>

<div class="toc-anchor"></div><h3>with_body()</h3>

<pre class="py-sign">VectorFEM.<b>with_body</b>(<em>self</em>, value)</pre>

<p>Defines the vector body.</p>

<p><b>Parameters</b></p>

<p><span class="vardef"><code>value</code> : <em>scalar | flat-float-array</em></span></p>

<dl><dd>
  Data that defines the vector body.
</dd></dl>

<p><b>Returns</b></p>

<p><span class="vardef"><em>VectorFEM</em></span></p>

<dl><dd>
  Copy of the vector with the body updated.
</dd></dl>

<div class="toc-anchor"></div><h3>from_func()</h3>

<pre class="py-sign">VectorFEM.<b>from_func</b>(<em>self</em>, func)</pre>

<p>Defines the vector via a function on the mesh nodes.</p>

<p><b>Parameters</b></p>

<p><span class="vardef"><code>func</code> : <em>Callable</em></span></p>

<dl><dd>
  Function <code>(x, y)</code> that returns the vector body.
</dd></dl>

<p><b>Returns</b></p>

<p><span class="vardef"><em>VectorFEM</em></span></p>

<dl><dd>
  Copy of the vector with the body updated.
</dd></dl>

<div class="toc-anchor"></div><h3>constrained()</h3>

<pre class="py-sign">VectorFEM.<b>constrained</b>(<em>self</em>)</pre>

<p>Constrains the vector on the parent mesh.</p>

<p><b>Returns</b></p>

<p><span class="vardef"><em>VectorFEM</em></span></p>

<dl><dd>
  Copy of the vector with the body constrained.
</dd></dl>

<div class="toc-anchor"></div><h3>getsection()</h3>

<pre class="py-sign">VectorFEM.<b>getsection</b>(<em>self</em>, sec_id)</pre>

<p>Returns a copy of the vector section.</p>

<p><b>Parameters</b></p>

<p><span class="vardef"><code>sec_id</code> : <em>int</em></span></p>

<dl><dd>
  ID of the vector section.
</dd></dl>

<p><b>Returns</b></p>

<p><span class="vardef"><em>flat-float-array</em></span></p>

<dl><dd>
  Copy of the vector section.
</dd></dl>

<div class="toc-anchor"></div><h3>setsection()</h3>

<pre class="py-sign">VectorFEM.<b>setsection</b>(<em>self</em>, sec_id, data) → <em>None</em></pre>

<p>Defines the vector section.</p>

<p><b>Parameters</b></p>

<p><span class="vardef"><code>sec_id</code> : <em>int</em></span></p>

<dl><dd>
  ID of the vector section.
</dd></dl>

<p><span class="vardef"><code>data</code> : <em>scalar | flat-float-array</em></span></p>

<dl><dd>
  Data that defines the vector section.
</dd></dl>

<div class="toc-anchor"></div><h2>mesh_grad()</h2>

<pre class="py-sign">triellipt.fem.<b>mesh_grad</b>(mesh)</pre>

<p>Returns the mesh gradient operator.</p>

<p><b>Parameters</b></p>

<p><span class="vardef"><code>mesh</code> : <em>TriMesh</em></span></p>

<dl><dd>
  Triangular mesh.
</dd></dl>

<p><b>Returns</b></p>

<p><span class="vardef"><em>TriGrad</em></span></p>

<dl><dd>
  Gradient operator on the mesh.
</dd></dl>

<p><b>Notes</b></p>

<p>
<ul class="md-list">
    <li><code>TriGrad</code> operates on nodes-based data</li>
    <li><code>TriGrad.diff_1x()</code> returns x-grad over triangles</li>
    <li><code>TriGrad.diff_1y()</code> returns y-grad over triangles</li>
    <li><code>TriGrad()</code> returns xy-grad over triangles</li>
</ul>
</p>

<div class="toc-anchor"></div><h2>mesh_geom()</h2>

<pre class="py-sign">triellipt.fem.<b>mesh_geom</b>(mesh)</pre>

<p>Returns the mesh geometric properties.</p>

<p><b>Parameters</b></p>

<p><span class="vardef"><code>mesh</code> : <em>TriMesh</em></span></p>

<dl><dd>
  Triangular mesh.
</dd></dl>

<p><b>Returns</b></p>

<p><span class="vardef"><em>MeshGeom</em></span></p>

<dl><dd>
  Object with the geometric properties of triangles.
</dd></dl>

<p><b>Notes</b></p>

<p><code>MeshGeom</code> object has the following attributes:</p>

<p>
<ul class="md-list">
    <li><code>areas</code> is a flat-array of triangle areas</li>
    <li><code>sides</code> is a 3col-table of triangle sides</li>
</ul>
</p>

<div class="toc-anchor"></div><h2>mesh_metric()</h2>

<pre class="py-sign">triellipt.fem.<b>mesh_metric</b>(mesh)</pre>

<p>Returns the mesh metric properties.</p>

<p><b>Parameters</b></p>

<p><span class="vardef"><code>mesh</code> : <em>TriMesh</em></span></p>

<dl><dd>
  Triangular mesh.
</dd></dl>

<p><b>Returns</b></p>

<p><span class="vardef"><em>MeshMetric</em></span></p>

<dl><dd>
  Object with the metric properties of triangles.
</dd></dl>

<p><b>Notes</b></p>

<p><code>MeshMetric</code> object has the following attributes:</p>

<p>
<ul class="md-list">
    <li><code>bcoeffs</code> is a 3col-table of b-coefficients.</li>
    <li><code>ccoeffs</code> is a 3col-table of c-coefficients.</li>
    <li><code>jacobis</code> is a flat-array of Jacobians.</li>
</ul>
</p>

<hr>
        </div>
        <p id="footnote">Copyright &copy; 2023, Igor Semenov.</p>
    </div>

    <footer></footer>

    <script>
        setDocPage();
    </script>

</body>

</html>